package handlers

import (
	"encoding/json"
	"fmt"
	"net/http"

	"github.com/gorilla/websocket"
	"github.com/pbogut/hackdeck/pkg/types"
)

var config types.Config

var upgrader = websocket.Upgrader{
	CheckOrigin: func(r *http.Request) bool {
		return true // Allow all connections (for development purposes)
	},
}

func handleConnected(msg []byte) types.GetConfig {
	var connected types.Connected
	json.Unmarshal(msg, &connected)

	get_config := types.GetConfig{
		Method:                        "GET_CONFIG",
		Rows:                          config.Rows,
		Columns:                       config.Columns,
		ButtonSpacing:                 config.ButtonSpacing,
		ButtonRadius:                  config.ButtonRadius,
		ButtonBackground:              config.ButtonBackground,
		Brightness:                    config.Brightness,
		AutoConnect:                   false,
		WakeLock:                      "Connected",
		SupportButtonReleaseLongPress: config.SupportButtonReleaseLongPress,
	}

	return get_config
}

func handleGetButtons() types.Buttons {
	buttons := types.NewGetButtons()
	buttons.AddButton(types.Button{
		IconBase64:         "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",
		PositionX:          1,
		PositionY:          0,
		LabelBase64:        "iVBORw0KGgoAAAANSUhEUgAAAPoAAAD6CAYAAACI7Fo9AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAASlSURBVHhe7d0hWCNHGAZgZGQkEolEIpFIJBKJRCLPIZFIJBIZiURGnozEHVVQdel8e0ObwG6gvYHehfd9nv/hspPZpOLbnczuTjcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgF/duNRlqZueuiq1U+q19p+VfVyX6vuMs1L5jucL2xYr/fZKASucHh0dzW9ubl7U6enpvLQ/vtKeg8DPmpyfn/d+xs7OTj7jYn9/v7c9/Up7Ag+s8KWY97m8vEyI5q+0twh6yexN3euyvb297jNysOmTfunf7QUYJOjwCbxX0PO7+7hUflt/qXVQqs97BH2r1GmpfO7Td8jnt5hTgN9Oy6Bn0uyi1Hx3d3d+fHzcvefi4qLbx8HBQd5/VyqhW9Qy6NulJltbW90cwtnZWfeefH72Ufd3X+r5d4C11iroCfks4Xp8fKzveOnu7u4p8Le1T7QK+s5oNPoj32uV2Wz2935/dIP11yrolwn5W+VsX/rk7B8tgj4qNb2+vq4tqz08PHyv+z4pBWuvRdA3x+Nx75k82+7v7+urf3z79u375uZm+meo3SLoR4eHh3Xrsowi+kyn0/TNT4kcJGCtDQZ9Mpl0QRsaCi8E/XgoiBmm5/d6n/QpfXNGbRH08nX6v2cOQicnJ/XVslyfL30PS8FaGwz6axaCPhiyBDUTY31q/+6OuAZB/1rUrctKW3dQ6VNv+jExx9p716An5ENBXwhpi6CXEfrLIXom3krbYNDz317aBZ211yLoZZQ/qVuX5RbVVJ+cgUvfr6VaBL1uWSbo8EOLoA8GdZUawtmq/oIObQi6oPMJDAa9Bvktl9cGg3p7e9uFsa+urq7S39AdPsC7Bj0TcaX9MfsZqEkpQYd39hFBn/W1G7rDx2kR9PLP4ctrpV3Q4X+2LkGf1U1Lcm29tAk6n16LoJ8NXSuvQe0m5Z7LtffSlpC2CPr0v9wZl+2l/agUrLUWQT/MPe19cotp7nXve+Al95+XvnmCrUXQrzKL3yf7yDPxz+UJtvpgjcUlWXstgp6nv+7yNNhbZUg9Go3SPyu+tAj6QRaS/DfqwpLTUrD2WgQ9TnLmHnokdFEeUa1PjWW56GgR9JgOndWfyzC/ns2HlreCtdIq6HE6Ho//zPYh+a1eJ+gyZH96DrxV0HdL3eW9fc/AP8nyUmU0kWv7Fp3g09gvteqGlgR5VXsWgFzULSRRar69vd09750DRf7mddme9dqeP/+dWe/n+32qvD/D+/zta0/lf/LwJMtT5XV3QMmBIqvZZA6hrhGfynDdIpHQSMKUoXGCnL85436kHHQy0ZYzd2bWTboBAAAAAAAAAL+QjY2/AHd7dpqiGk2gAAAAAElFTkSuQmCC",
		BackgroundColorHex: "#232323",
	})
	buttons.AddButton(types.Button{
		IconBase64:         "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",
		PositionX:          0,
		PositionY:          0,
		LabelBase64:        "",
		BackgroundColorHex: "#232323",
	})
	buttons.AddButton(types.Button{
		IconBase64:         "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",
		PositionX:          2,
		PositionY:          2,
		LabelBase64:        "iVBORw0KGgoAAAANSUhEUgAAAPoAAAD6CAYAAACI7Fo9AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAASlSURBVHhe7d0hWCNHGAZgZGQkEolEIpFIJBKJRCLPIZFIJBIZiURGnozEHVVQdel8e0ObwG6gvYHehfd9nv/hspPZpOLbnczuTjcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgF/duNRlqZueuiq1U+q19p+VfVyX6vuMs1L5jucL2xYr/fZKASucHh0dzW9ubl7U6enpvLQ/vtKeg8DPmpyfn/d+xs7OTj7jYn9/v7c9/Up7Ag+s8KWY97m8vEyI5q+0twh6yexN3euyvb297jNysOmTfunf7QUYJOjwCbxX0PO7+7hUflt/qXVQqs97BH2r1GmpfO7Td8jnt5hTgN9Oy6Bn0uyi1Hx3d3d+fHzcvefi4qLbx8HBQd5/VyqhW9Qy6NulJltbW90cwtnZWfeefH72Ufd3X+r5d4C11iroCfks4Xp8fKzveOnu7u4p8Le1T7QK+s5oNPoj32uV2Wz2935/dIP11yrolwn5W+VsX/rk7B8tgj4qNb2+vq4tqz08PHyv+z4pBWuvRdA3x+Nx75k82+7v7+urf3z79u375uZm+meo3SLoR4eHh3Xrsowi+kyn0/TNT4kcJGCtDQZ9Mpl0QRsaCi8E/XgoiBmm5/d6n/QpfXNGbRH08nX6v2cOQicnJ/XVslyfL30PS8FaGwz6axaCPhiyBDUTY31q/+6OuAZB/1rUrctKW3dQ6VNv+jExx9p716An5ENBXwhpi6CXEfrLIXom3krbYNDz317aBZ211yLoZZQ/qVuX5RbVVJ+cgUvfr6VaBL1uWSbo8EOLoA8GdZUawtmq/oIObQi6oPMJDAa9Bvktl9cGg3p7e9uFsa+urq7S39AdPsC7Bj0TcaX9MfsZqEkpQYd39hFBn/W1G7rDx2kR9PLP4ctrpV3Q4X+2LkGf1U1Lcm29tAk6n16LoJ8NXSuvQe0m5Z7LtffSlpC2CPr0v9wZl+2l/agUrLUWQT/MPe19cotp7nXve+Al95+XvnmCrUXQrzKL3yf7yDPxz+UJtvpgjcUlWXstgp6nv+7yNNhbZUg9Go3SPyu+tAj6QRaS/DfqwpLTUrD2WgQ9TnLmHnokdFEeUa1PjWW56GgR9JgOndWfyzC/ns2HlreCtdIq6HE6Ho//zPYh+a1eJ+gyZH96DrxV0HdL3eW9fc/AP8nyUmU0kWv7Fp3g09gvteqGlgR5VXsWgFzULSRRar69vd09750DRf7mddme9dqeP/+dWe/n+32qvD/D+/zta0/lf/LwJMtT5XV3QMmBIqvZZA6hrhGfynDdIpHQSMKUoXGCnL85436kHHQy0ZYzd2bWTboBAAAAAAAAAL+QjY2/AHd7dpqiGk2gAAAAAElFTkSuQmCC",
		BackgroundColorHex: "#232323",
	})

	return buttons
}

func handleButtonPress(x, y int) types.Buttons {
	fmt.Printf("Button pressed at x: %d, y: %d\n", x, y)

	return types.NewUpdateButton()
}

func handleButtonLongPress(x, y int) types.Buttons {
	fmt.Printf("Button long pressed at x: %d, y: %d\n", x, y)

	return types.NewUpdateButton()
}

func handleButtonRelease(x, y int) types.Buttons {
	fmt.Printf("Button released at x: %d, y: %d\n", x, y)

	return types.NewUpdateButton()
}

func handleButtonLongPressRelease(x, y int) types.Buttons {
	fmt.Printf("Button long press released at x: %d, y: %d\n", x, y)

	return types.NewUpdateButton()
}

func msgToXY(msg []byte) (int, int) {
	var action types.ClickAction
	json.Unmarshal(msg, &action)
	return action.GetXY()
}

// WebSocket handler
func WsHandler(w http.ResponseWriter, r *http.Request) {
	config = types.ReadConfig()

	// Upgrade the HTTP connection to a WebSocket connection
	conn, err := upgrader.Upgrade(w, r, nil)
	if err != nil {
		fmt.Println("Error while upgrading connection:", err)
		return
	}
	defer conn.Close()
	fmt.Println("Client connected")
	// Echo messages back to the client
	for {
		// Read message from the client
		messageType, msg, err := conn.ReadMessage()
		if err != nil {
			fmt.Println("Error while reading message:", err)
			break
		}

		var result interface{}
		var method types.Method
		json.Unmarshal(msg, &method)

		switch method.Method {
		case "BUTTON_LONG_PRESS":
			x, y := msgToXY(msg)
			result = handleButtonLongPress(x, y)
		case "BUTTON_LONG_PRESS_RELEASE":
			x, y := msgToXY(msg)
			result = handleButtonLongPressRelease(x, y)
		case "BUTTON_PRESS":
			x, y := msgToXY(msg)
			result = handleButtonPress(x, y)
		case "BUTTON_RELEASE":
			x, y := msgToXY(msg)
			result = handleButtonRelease(x, y)
		case "GET_BUTTONS":
			result = handleGetButtons()
		case "CONNECTED":
			result = handleConnected(msg)
		}

		response, err := json.Marshal(result)
		if err != nil {
			break
		}
		conn.WriteMessage(messageType, response)

		// Print the received message
		fmt.Printf("Received: %s\n", msg)
	}
}
